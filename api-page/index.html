<!DOCTYPE html>
<html lang="en" class="dark">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="theme-color" content="#1b1b1b">
<title>Manzxy API</title>
<link rel="icon" href="/assets/icon.png">

<!-- Tailwind -->
<script src="https://cdn.tailwindcss.com"></script>

<!-- Minecraft Font -->
<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">

<!-- Icons -->
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">

<script>
tailwind.config = {
  darkMode: 'class',
  theme: {
    extend: {
      fontFamily: {
        minecraft: ['Press Start 2P', 'monospace']
      }
    }
  }
}
</script>

<style>
::-webkit-scrollbar { display: none }

/* ===== DARK BACKGROUND (DEFAULT) ===== */
.bg-dark {
  background:
    repeating-linear-gradient(
      45deg,
      #1b1b1b,
      #1b1b1b 14px,
      #161616 14px,
      #161616 28px
    );
  color: #e5e7eb;
}

/* ===== LIGHT BACKGROUND ===== */
.bg-light {
  background:
    repeating-linear-gradient(
      45deg,
      #f5f5f5,
      #f5f5f5 14px,
      #ffffff 14px,
      #ffffff 28px
    );
  color: #111111;
}

/* Panel */
.mc-panel {
  background: #2a2a2a;
  border: 4px solid #3f3f3f;
  box-shadow:
    inset -4px -4px 0 #1a1a1a,
    inset 4px 4px 0 #4a4a4a;
}
.bg-light .mc-panel {
  background: #eeeeee;
  border-color: #cccccc;
  box-shadow:
    inset -4px -4px 0 #cfcfcf,
    inset 4px 4px 0 #ffffff;
}

/* Button */
.mc-btn {
  background: #3a7d3a;
  border: 3px solid #2b5d2b;
  box-shadow:
    inset -3px -3px 0 #1f3f1f,
    inset 3px 3px 0 #5fa75f;
  transition: .1s;
  color: #000;
}
.mc-btn:hover {
  transform: translateY(-2px);
}

/* Input */
.mc-input {
  background: #1e1e1e;
  border: 3px solid #3f3f3f;
}
.bg-light .mc-input {
  background: #ffffff;
  border-color: #cccccc;
}

/* Status */
.status-ready { background:#2ecc71;color:#003300 }
.status-update { background:#f1c40f;color:#332200 }
.status-error { background:#e74c3c;color:#330000 }

/* Loader */
.loader {
  width: 22px;
  height: 22px;
  border: 4px solid #2ecc71;
  border-top-color: transparent;
  animation: spin .8s linear infinite;
}
@keyframes spin { to { transform: rotate(360deg) } }
</style>
</head>

<body class="font-minecraft bg-dark min-h-screen">

<main class="max-w-3xl mx-auto px-6 py-10 mc-panel">

<!-- HEADER -->
<div class="flex items-center justify-between mb-6">
  <div class="flex items-center gap-4">
    <img src="/assets/icon.png" class="w-10">
    <h1 class="text-lg tracking-widest text-green-500">MANZXY API</h1>
  </div>

  <!-- TOGGLE BACKGROUND -->
  <button id="bgToggle" class="mc-btn px-3 py-2 text-xs">
    WHITE
  </button>
</div>

<p class="text-xs mb-6">
Explore endpoints like opening a Minecraft chest.
</p>

<a href="https://t.me/manzxyyx" target="_blank"
class="text-xs underline block mb-6">
Contact Manzxy
</a>

<!-- NOTIFICATIONS -->
<div class="mb-6">
  <h2 class="text-xs mb-2 flex items-center">
    <span class="material-icons mr-2">notifications</span>
    INFORMATION
  </h2>
  <div id="notifications-list" class="space-y-2">
    <div class="loader"></div>
  </div>
</div>

<!-- SEARCH -->
<input id="searchInput" placeholder="Search API..."
class="w-full px-4 py-3 mc-input text-xs mb-6 focus:outline-none">

<!-- CONTENT -->
<div id="content" class="space-y-3">
  <div id="noResults" class="hidden text-center text-xs">
    No result found
  </div>
  <div id="apiList" class="space-y-3"></div>
</div>

<footer class="mt-10 text-center text-xs">
¬© 2025 Manzxy
</footer>

</main>

<script>
/* ===== BACKGROUND TOGGLE ===== */
const btn = document.getElementById('bgToggle')
const body = document.body

function setBg(mode){
  body.classList.remove('bg-dark','bg-light')
  body.classList.add(mode)
  btn.textContent = mode === 'bg-dark' ? 'WHITE' : 'BLACK'
  localStorage.setItem('bgMode', mode)
}

btn.onclick = () => {
  setBg(body.classList.contains('bg-dark') ? 'bg-light' : 'bg-dark')
}

setBg(localStorage.getItem('bgMode') || 'bg-dark')

/* ===== API + NOTIF ===== */
function toggleCategory(i){
  document.getElementById('category-'+i)?.classList.toggle('hidden')
}
function toggleEndpoint(c,e){
  document.getElementById(`endpoint-${c}-${e}`)?.classList.toggle('hidden')
}

async function loadApis(){
  const apiList=document.getElementById('apiList')
  const res=await fetch('/assets/settings.json')
  const data=await res.json()
  let html=''
  data.categories.forEach((cat,ci)=>{
    html+=`
    <div class="mc-panel">
      <button onclick="toggleCategory(${ci})"
      class="w-full px-4 py-3 text-left text-xs">
        üìÅ ${cat.name} (${cat.items.length})
      </button>
      <div id="category-${ci}" class="hidden">`
    cat.items.forEach((it,ei)=>{
      html+=`
      <div class="border-t border-gray-500 api-item"
        data-path="${it.path}"
        data-alias="${it.name}"
        data-description="${it.desc}">
        <button onclick="toggleEndpoint(${ci},${ei})"
        class="w-full px-4 py-3 text-left text-xs">
          ‚ñ∂ ${it.path}
        </button>
        <div id="endpoint-${ci}-${ei}" class="hidden p-4 text-xs">
          ${it.desc || ''}
        </div>
      </div>`
    })
    html+='</div></div>'
  })
  apiList.innerHTML=html
}

async function loadNotifications(){
  const box=document.getElementById('notifications-list')
  const res=await fetch('/notifications.json')
  const data=await res.json()
  box.innerHTML=''
  data.forEach(n=>{
    box.innerHTML+=`
    <div class="mc-panel p-3 text-xs">
      <b>${n.title}</b><br>${n.message}
    </div>`
  })
}

document.getElementById('searchInput').addEventListener('input',function(){
  const q=this.value.toLowerCase()
  let visible=0
  document.querySelectorAll('.api-item').forEach(i=>{
    const ok =
      i.dataset.path.toLowerCase().includes(q) ||
      i.dataset.alias.toLowerCase().includes(q) ||
      i.dataset.description.toLowerCase().includes(q)
    i.style.display = ok ? '' : 'none'
    if(ok) visible++
  })
  document.getElementById('noResults').classList.toggle('hidden',visible!==0)
})

document.addEventListener('DOMContentLoaded',()=>{
  loadApis()
  loadNotifications()
})
</script>

</body>
</html>
